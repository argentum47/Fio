<!doctype html>
<html ng-app="fio">
<head>
  <title>Raha</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- The grid -->
  <link rel="stylesheet" href="http://yui.yahooapis.com/combo?pure/0.2.0/base-min.css&pure/0.2.0/grids-min.css&pure/0.2.0/forms-min.css">

  <!-- The styles -->
  <link rel="stylesheet" href="static/styles/css/main.css">
  
  <!-- The before-load scripts -->
  <script src="http://modernizr.com/downloads/modernizr-2.5.3.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
  <script src="static/js/app.js"></script>
 
</head>
<body>

	<div ng-controller="DataCtrl" ng-init="init_data_ctrl()">

		<section class="s-total">
			<div class="cw">
				<div class="c all-totals">
					<span class="c date">Total income:</span>
					<span class="c amount">{{ get_totals().inc | number:2 }}</span>
					<span class="c date">Total expenses:</span>
					<span class="c amount">{{ get_totals().exp | number:2 }}</span>
					<span class="c date">Balance:</span>
					<span class="c amount">{{ get_totals().balance | number:2 }}</span>
				</div>
				<div class="c note"><input type="text" placeholder="Search everything" ng-model="filters.$" /></div>
			</div>
		</section>

		<section class="s-headings">
			<div class="cw">
				<div class="c date">Date</div>
				<div class="c amount">Amount</div>
				<div class="c category">
					<select ng-model="filters.category">
					  <option value="">Everything</option>
					  <option value="Groceries">Groceries</option>
					  <option value="Entertainment">Entertainment</option>
					  <option value="Salary">Salary</option>
					  <option value="Eating out">Eating out</option>
					  <option value="Cinema">Cinema</option>
					</select>
				</div>
				<div class="c note"><input type="text" placeholder="Search notes" ng-model="filters.note" /></div>
			</div>
		</section>

		<section class="s-new-entry">
			<div class="cw">
				<form name="add-entry" ng-submit="add_entry()">
					<div class="c date"><input type="date" name="date" ng-model="date" required /></div>
					<div class="c amount"><input type="number" step="any" ng-model="amount" required /></div>
					<div class="c category"><input type="text" ng-model="category" required /></div>
					<div class="c note"><input type="text" ng-model="note" /></div>
					<input type="submit" value="Add" style="position: absolute; left: -9999px" />
				</form>
			</div>
		</section>

		<section class="s-data">
			<div class="cw">
				<div class="daily" ng-repeat="daily in dailies | orderBy:order" ng-show="filtered_entries.length">
					<div class="c date">{{ daily.date | date: 'dd.MM.yyyy' }}</div>
					<div class="c entries">
						<div class="entry" ng-repeat="entry in filtered_entries = (daily.subentries | filter: filters)" ng-init="editing=false">
							<div ng-hide="editing">
								<div class="c amount {{ get_type(entry.amount) }}">{{ entry.amount | number:2 }}</div>
								<div class="c category">{{ entry.category }}</div>
								<div class="c note">{{ entry.note }}</div>
								<span class="edit" ng-click="edit_entry(daily.$$hashKey, entry.$$hashKey);editing=true">[e]</span>
							</div>
							<div ng-show="editing">
								<form ng-submit="editing=false">
									<div class="c amount"><input type="number" step="any" value="{{ daily.entry.amount }}" ng-model="entry.amount" /></div>
									<div class="c category"><input type="text" value="{{ daily.entry.category }}" ng-model="entry.category" /></div>
									<div class="c note"><input type="text" value="{{ daily.entry.note }}" ng-model="entry.note" /></div>
									<input type="submit" value="OK" style="position: absolute; left: -9999px" />
								</form>
								<span class="cancel-edit" ng-click="editing=false">[c]</span>
							</div>
							<span class="remove" ng-click="remove_entry(daily.$$hashKey, entry.$$hashKey)">[x]</span>
						</div>
					</div> <!-- .c.entries -->
					<div class="c full total">
						<div class="c amount">{{ get_daily_totals(daily).balance | number:2 }}</div>
					</div>
				</div> <!-- .daily -->
				<div class="no-data" ng-show="dailies.length < 1">No entries added</div>
			</div>
		</section>

	</div>

	<!-- The document.ready scripts -->

</body>